1.1
SELECT COUNT(*) AS num_accounts
FROM accounts
WHERE cust_id IN (
    SELECT cust_id
    FROM customer
    WHERE location_pincode IN (
        SELECT location_pincode
        FROM city
        WHERE cityname = 'Hyderabad'
    )
)
AND balance_inlakhs > 1;

1.2
SELECT COUNT(*) AS num_branches
FROM branch
WHERE ifsc_code IN (
    SELECT ifsc_code
    FROM accounts
    WHERE cust_id IN (
        SELECT cust_id
        FROM customer
        WHERE location_pincode IN (
            SELECT location_pincode
            FROM city
            WHERE cityname = 'Vizag'
        )
        AND gender = 'female'
    )
)
GROUP BY ifsc_code
HAVING COUNT(*) > 2;

1.3
SELECT name
FROM customer
WHERE cust_id IN (
    SELECT cust_id
    FROM accounts
    WHERE ifsc_code IN (
        SELECT ifsc_code
        FROM branch
        WHERE branch_name = 'Gandipet'
    )
    GROUP BY cust_id
    HAVING COUNT(*) > 1
);

1.4
SELECT cityname
FROM city
WHERE location_pincode = (
    SELECT location_pincode
    FROM customer
    WHERE location_pincode = (
        SELECT location_pincode
        FROM accounts
        GROUP BY location_pincode
        ORDER BY AVG(balance_inlakhs) ASC
        LIMIT 1
    )
    LIMIT 1
);