create database demo3;
use demo3;
CREATE TABLE artists (
  artist_id INT PRIMARY KEY,
  name VARCHAR(50),
  location_pincode INT
  
);

CREATE TABLE skills (
  skills_id INT PRIMARY KEY,
  skill_name VARCHAR(50)
);

CREATE TABLE artists_skills (
  artist_id INT,
  skill_id INT,
  exp_in_years INT,
  PRIMARY KEY (artist_id, skill_id)
);

CREATE TABLE movies (
  movie_name VARCHAR(50),
  artist_id INT,
  language VARCHAR(50),
  genre VARCHAR(50),
  PRIMARY KEY (movie_name, artist_id)
);

CREATE TABLE city (
  pincode INT PRIMARY KEY,
  cityname VARCHAR(50),
  state VARCHAR(50)
);

-- Insert sample values into the artists table
INSERT INTO artists (artist_id, name, location_pincode)
VALUES
  (1, 'Artist 1', 12345),
  (2, 'Artist 2', 54321),
  (3, 'Artist 3', 67890),
  (4, 'Artist 4', 98765),
  (5, 'Artist 5', 23456);

-- Insert sample values into the skills table
INSERT INTO skills (skills_id, skill_name)
VALUES
  (1, 'director'),
  (2, 'producer'),
  (3, 'music director'),
  (4, 'singer');

-- Insert sample values into the artists_skills table
INSERT INTO artists_skills (artist_id, skill_id, exp_in_years)
VALUES
  (1, 1, 3),
  (1, 2, 2),
  (2, 3, 6),
  (3, 2, 4),
  (4, 3, 8),
  (4, 4, 5),
  (5, 4, 2);

-- Insert sample values into the movies table
INSERT INTO movies (movie_name, artist_id, language, genre)
VALUES
  ('KGF1', 1, 'Action', 'action'),
  ('RRR', 1, 'Telugu', 'action'),
  ('Pushpa', 1, 'Telugu', 'action'),
  ('Movie 4', 4, 'Action', 'thriller'),
  ('Movie 5', 5, 'Telugu', 'romance');

-- Insert sample values into the city table
INSERT INTO city (pincode, cityname, state)
VALUES
  (12345, 'Hyderabad', 'Telangana'),
  (54321, 'Chennai', 'Tamil Nadu'),
  (67890, 'Mumbai', 'Maharashtra'),
  (98765, 'Delhi', 'Delhi'),
  (23456, 'Bangalore', 'Karnataka');
  
SELECT name
FROM artists
WHERE artist_id IN (
    SELECT artist_id
    FROM artists_skills
    WHERE skill_id IN (
        SELECT skills_id
        FROM skills
        WHERE skill_name = 'director' OR skill_name = 'producer'
    )
)
AND artist_id IN (
    SELECT artist_id
    FROM movies
    WHERE genre = 'action'
);

SELECT name
FROM artists
WHERE artist_id IN (
    SELECT artist_id
    FROM artists_skills
    WHERE skill_id = (
        SELECT skills_id
        FROM skills
        WHERE skill_name = 'music director'
    )
    AND exp_in_years >= 5
    AND artist_id IN (
        SELECT artist_id
        FROM movies
        WHERE language = 'Telugu'
    )
)
AND location_pincode IN (
    SELECT pincode
    FROM city
    WHERE cityname = 'Hyderabad'
);


SELECT name
FROM artists
WHERE artist_id IN (
    SELECT artist_id
    FROM movies
    WHERE movie_name IN ('KGF1', 'RRR', 'Pushpa')
);